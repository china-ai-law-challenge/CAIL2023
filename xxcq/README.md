# CAIL2023--司法文本信息抽取

该项目为 **CAIL2023—司法文本信息抽取** 的代码和模型提交说明。

## 数据说明

本次任务所使用的数据集来自研究开源的盗窃类罪名法律文书，总计2348条数据。入门赛阶段数据集包含约1643条数据，邀测赛阶段数据集包括705条数据，每条样本中均包含任意数目的实体关系三元组。数据集涵盖了盗窃类案件的常见情景。数据集预定义了四种关系类型，分别为“盗窃”、“交易”、“所有”和“共犯”，每种关系类型的定义如下：
1）“盗窃”是指嫌疑人盗窃物品的行为，实体是嫌疑人和被盗窃的物品；
2）“所有”表示受害人与被盗窃物品之间的所有权关系，实体代表受害人和被盗窃物品；
3）“交易”是指嫌疑人处置被盗物品的去向；
4）“共犯”是犯罪嫌疑人之间合作关系的集中体现，犯罪主体之间存在共同犯罪关系。

## 数据格式

json文件存储，格式参考NYT数据集格式，包括Id（文本编号），sentText（段落文本），entityMentions（实体列表），relationMentions（关系列表）等字段，其中entityMentions包括start（实体左边界）、end（实体右边界）、text（实体内容）、label（实体类型）；relationMentions包括e1start（头实体左边界）、e1text（头实体内容）、e21start（尾实体左边界）、e2text（尾实体内容）、label（关系类型）。

## 提交内容

我们将给出所有的测试集，其中200条测试集加入了9800条的混淆集，共10000条数据，选手需要对这10000条的数据进行预测，交给选手预测的数据只有文本内容，选手需要按照训练集的格式，生成对应的**false.json**文件进行提交，其中问题编号可以随机生成，段落文本即为给出的文本内容，剩余的内容可以参照数据格式介绍和训练集，注意在提交结果时不可以打乱文本的顺序，我们将在10000条数据中提取出200条测试集，作为最后的测评数据，给出结果成绩。

## 基线模型

我们将提供一个DGCNN+Attention模型作为深度基线模型，该模型是基于CNN和简单的Attention的结构。模型中的CNN为DGCNN，融合了膨胀卷积与门卷积的用法，使得模型在轻、快的基础上达到最佳的效果。Attention采用了简单的Self Attention。整体而言，模型参考了类似seq2seq的概率图思路，先识别实体1，然后传入实体1来同时识别关系和实体2，可以很好地覆盖抽取任务中各个样本的特点。
模型来自于 https://github.com/tianyunzqs/RelationshipExtractionTasks/tree/master   请在运行代码前从原代码库下载词向量。

## 模型依赖

```shell
gensim==3.8.0
tensorflow==1.14.0
keras==2.3.1
h5py==2.8.0
```

## 运行说明

从原代码仓库下载词向量 vector 文件，放在 baseline 目录下。

将数据集放至 data 文件夹下，运行 data_preprocess.py，将数据处理为模型能够处理的输入。

完成数据的处理后，运行 dgcnn_attention 文件夹下的 train.py 文件训练模型。训练完成需要进行测试时，将代码中的 do_train 变量修改为 False。
